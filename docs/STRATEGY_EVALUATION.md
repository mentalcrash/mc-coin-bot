# Strategy Evaluation Log

이 문서는 테스트한 전략들의 평가와 교훈을 기록합니다.
같은 실수를 반복하지 않고 더 나은 전략을 개발하기 위한 지식 베이스입니다.

---

## VW-TSMOM (Volume-Weighted Time Series Momentum)

**평가 일자:** 2026-02-06 (8년 검증 업데이트)
**상태:** ✅ 채택 (핵심 전략)
**테스트 기간:** 2018-01-01 ~ 2025-12-31 (8년)

### 개요

학술 연구(SSRN #4825389)에 기반한 거래량 가중 시계열 모멘텀 전략.
변동성 타겟팅을 통해 포지션 크기를 조절하는 리스크 조정 접근법.

### 최종 설정

```python
TSMOMConfig(
    lookback=30,
    vol_window=30,
    vol_target=0.30,          # 0.25 → 0.30 (Sharpe 1.0 유지하며 수익 +20%)
    hedge_threshold=-0.07,    # -7% 드로다운 시 헤지 숏 활성화
    hedge_strength_ratio=0.8, # 롱 대비 80% 강도의 헤지
    short_mode=ShortMode.HEDGE_ONLY,
)
```

### 성과 요약 (8년: 2018-2025)

| 기간 | Return | Sharpe | MDD | Win Rate | CAGR | Trades |
|------|--------|--------|-----|----------|------|--------|
| **2018-2025 전체** | **+782.4%** | **1.04** | **43.5%** | **54.3%** | **+31.3%** | **349** |
| 2023-2025 (3년) | +114.7% | 1.01 | 27.2% | 54.4% | +114.7% | 137 |
| BTC B&H (8년) | +555.1% | 0.69 | 81.2% | 51.1% | +26.5% | - |

#### 연도별 성과

| 연도 | BTC 레짐 | Sharpe | Return | MDD | Win Rate |
|------|----------|--------|--------|-----|----------|
| 2018 | 하락장 (-73%) | -1.09 | -27.5% | 43.5% | 48.9% |
| 2019 | 회복 (+95%) | 1.57 | +61.4% | 27.1% | 53.3% |
| 2020 | COVID+반등 (+305%) | 2.59 | +132.1% | 12.3% | 70.4% |
| 2021 | 불장+조정 (+59%) | 1.03 | +25.7% | 20.4% | 53.3% |
| 2022 | 하락장 (-64%) | -1.06 | -27.7% | 33.7% | 31.0% |
| 2023 | 회복 (+157%) | 1.06 | +31.4% | 18.1% | 58.8% |
| 2024 | 불장 (+112%) | 1.37 | +44.4% | 27.2% | 60.9% |
| 2025 | 혼조 | 0.97 | +24.6% | 20.5% | 52.4% |

**핵심 관찰:** 하락장(2018, 2022)에서만 손실, 나머지 6년은 모두 양수. 8년 전체 Sharpe 1.04로 우수.

### 시도한 것들

#### 1. ADX 횡보장 필터 ❌
- **가설:** ADX < 25일 때 포지션 축소하면 횡보장 손실 감소
- **결과:** MDD 개선 (36.5% → 23.2%) but Sharpe 유지/소폭 하락
- **결론:** 복잡성 대비 이익 미미, 기본값 OFF 유지

```python
# 테스트 설정
use_sideways_filter=True, adx_threshold=35, sideways_position_scale=0.5
```

#### 2. 다중 타임프레임(MTF) 필터 ❌
- **가설:** 주간 추세 방향과 일치할 때만 진입하면 승률 향상
- **결과:** 역추세 진입 감소했으나, 강세장에서 유효 시그널도 필터링
- **결론:** 횡보장/약세장에서 유용할 수 있으나, 현재 불필요

| MTF 모드 | Sharpe | MDD | 평가 |
|----------|--------|-----|------|
| OFF | 1.05 | 23.14% | ✅ 베스트 |
| CONSENSUS | 1.01 | 21.85% | 과도한 필터링 |
| VETO | 0.96 | 21.85% | 성과 저하 |
| WEIGHTED | 0.96 | 24.93% | 성과 저하 |

#### 3. 레버리지 조절 (vol_target) ✅
- **발견:** max_leverage보다 vol_target이 실제 레버리지 결정
- **최적점:** vol_target=0.30 (Sharpe ≥1.0 유지, 수익 +20%)

| vol_target | Return | Sharpe | MDD |
|------------|--------|--------|-----|
| 0.25 | +95.70% | 1.03 | 23.14% |
| **0.30** | **+114.67%** | **1.01** | **27.16%** |
| 0.35 | +123.10% | 0.96 | 31.50% |
| 0.40 | +126.30% | 0.91 | 35.51% |

#### 4. 헤지 숏 모드 ✅
- **목적:** 드로다운 시 헤지 포지션으로 손실 제한
- **최적 설정:** threshold=-0.07, strength=0.8
- **효과:** Long-Only 대비 MDD 개선

### 전략의 강점

1. **8년간 안정적인 Sharpe Ratio (1.04)**
   - 상승/하락/횡보 모든 레짐 포함 8년 데이터 검증
   - Bear 레짐(60일 누적 수익 < -10%)에서도 Sharpe 1.04 유지
   - 과적합이 아님을 장기 데이터로 확인

2. **BTC B&H 대비 우월한 리스크 조정 수익**
   - TSMOM Sharpe 1.04 vs BTC B&H Sharpe 0.69
   - TSMOM MDD -43.5% vs BTC B&H MDD -81.2%
   - Calmar Ratio: TSMOM 0.72 vs BTC B&H 0.33

3. **레버리지 조절로 수익 확장 가능**
   - vol_target 증가로 리스크-리턴 트레이드오프 조절
   - CAGR +31.3%로 BTC B&H(+26.5%) 상회

### 전략의 한계

1. **하락장에서 큰 손실 (2018: -27.5%, 2022: -27.7%)**
   - 추세 추종이지만 급격한 하락에는 손실 불가피
   - 2018년 MDD -43.5%는 관리 한계 수준

2. **횡보장(Sideways)에서 음의 Sharpe (-1.13)**
   - Whipsaw 손실: 추세가 없는 구간에서 반복적인 손절
   - 전체 시간의 30.3%가 횡보 → 유의미한 약점

3. **높은 거래 비용 민감도**
   - 349 trades / 8 years = ~44 trades/year
   - 슬리피지, 스프레드에 수익 잠식

### 교훈 (Lessons Learned)

1. **리스크 조정 수익이 핵심 지표**
   - 절대 수익보다 Sharpe, Sortino, MDD 중시
   - Sharpe 1.0 이상이면 레버리지로 수익 확장 가능

2. **복잡성 ≠ 성과**
   - MTF 필터, ADX 필터 등 추가 로직이 항상 개선은 아님
   - 단순한 구조가 강건함

3. **백테스트 기간은 충분히 길어야 함**
   - 3년(2023-2025)은 불장 편향 → 8년(2018-2025)으로 확장하니 하락장 취약점 발견
   - 최소 1회의 상승/하락/횡보 사이클 포함 필요

4. **vol_target > max_leverage**
   - 실제 레버리지는 vol_target / realized_vol로 결정
   - max_leverage는 상한선일 뿐

---

## BB+RSI Mean Reversion

**평가 일자:** 2026-02-06
**상태:** ⚠️ 보류 (단독 운영 부적합, 분산 효과용으로만 가치)
**테스트 기간:** 2018-01-01 ~ 2025-12-31 (8년)

### 개요

볼린저밴드 + RSI 기반 평균회귀 전략.
가격이 BB 하단 + RSI 과매도일 때 매수, 상단 + 과매수일 때 매도.
TSMOM의 약점(횡보장)을 보완할 목적으로 개발.

### 최종 설정 (파라미터 스윕 최적)

```python
BBRSIConfig(
    bb_period=20,
    bb_std=2.0,
    rsi_period=14,
    bb_weight=0.7,            # BB 신호 가중치 (RSI보다 안정적)
    rsi_weight=0.3,
    vol_target=0.15,          # 보수적 변동성 타겟
    use_adx_filter=False,     # ADX 필터 OFF가 전 기간 최적
    short_mode=ShortMode.DISABLED,  # Long-only
)
```

### 성과 요약 (8년: 2018-2025)

| 설정 | Return | Sharpe | MDD | Win Rate | CAGR | AnnVol |
|------|--------|--------|-----|----------|------|--------|
| **최적 (위 설정)** | **+4.5%** | **0.11** | **15.8%** | **58.0%** | **+0.5%** | **7.3%** |
| 기본값 (ADX ON) | -0.6% | 0.02 | 15.3% | 55.7% | -0.1% | 5.6% |
| 2023-2025만 (최적) | +13.9% | 0.72 | 5.2% | 60.1% | +13.9% | 7.8% |

#### 연도별 성과 (최적 설정)

| 연도 | BTC 레짐 | Sharpe | Return | MDD | Win Rate |
|------|----------|--------|--------|-----|----------|
| 2018 | 하락장 | -0.93 | -8.5% | 11.7% | 57.5% |
| 2019 | 회복 | 0.60 | +4.2% | 5.4% | 60.0% |
| 2020 | COVID+반등 | 0.10 | +0.5% | 9.8% | 47.8% |
| 2021 | 불장+조정 | 0.11 | +0.5% | 6.3% | 48.1% |
| 2022 | 하락장 | -1.03 | -6.8% | 12.1% | 55.0% |
| **2023** | **회복** | **1.14** | **+6.4%** | **4.5%** | **61.0%** |
| 2024 | 불장 | 0.47 | +2.5% | 5.2% | 56.2% |
| 2025 | 혼조 | 0.10 | +0.4% | 4.8% | 56.9% |

### 시도한 것들

#### 1. ADX 필터 (추세장 억제) ❌
- **가설:** ADX >= 25일 때 포지션 축소하면 추세장 손실 감소 (TSMOM과 반대 방향)
- **결과:** 2023-2025(불장)에서 포지션 과도 억제, 전체 기간 Sharpe 0.02로 하락
- **결론:** 불장 비중이 43.6%인 BTC에서 추세장 억제는 치명적

```
ADX ON:  8년 Sharpe 0.02, Return -0.6%
ADX OFF: 8년 Sharpe 0.11, Return +4.5%  ← 압도적 우위
```

#### 2. 파라미터 스윕 (72개 조합) ✅
- bb_weight 0.3~0.8, vol_target 0.15~0.40, short_mode 0/1/2
- **발견:** Long-only(short_mode=0)가 모든 조합에서 최적
- **발견:** BB weight 0.7 > 0.6 (RSI보다 BB position이 안정적)
- **발견:** 낮은 vol_target(0.15)이 높은 Sharpe 유지

#### 3. Short Mode (HEDGE/FULL) ❌
- **결과:** 2018-2025에서 Long-only가 압도적 최적
- **원인:** BTC는 장기적으로 우상향 → 숏은 구조적 역풍

### 전략의 강점

1. **매우 낮은 변동성 (AnnVol 7.3%)**
   - TSMOM(30.7%)의 1/4 수준
   - BTC B&H(65.7%)의 1/9 수준

2. **횡보장에서 유일한 양수 Sharpe (0.83)**
   - TSMOM은 횡보장 Sharpe -1.13
   - 전체 시간의 30.3%가 횡보 → 보완 가치 존재

3. **TSMOM과 음의 상관 (r = -0.265)**
   - 포트폴리오 분산 효과의 핵심 조건 충족
   - 연도별: 2018(-0.53), 2022(-0.39), 2025(-0.50)

### 전략의 한계

1. **단독 alpha 부재 (8년 CAGR +0.5%)**
   - 8년간 거의 제로 수익 → 단독 운영 불가
   - 2023-2025에서 최적화한 파라미터가 2018-2022에서 역효과 (과적합 시그널)

2. **하락장에서 손실 (Long-only dip buying)**
   - 2018: -8.5%, 2022: -6.8%
   - 평균회귀 = 하락 시 매수 → 하락장에서는 "떨어지는 칼 잡기"

3. **낮은 절대 수익**
   - 높은 Win Rate(58%)에도 불구하고 수익 미미
   - 평균 수익 대비 평균 손실 비율이 낮음

### 교훈 (Lessons Learned)

1. **3년 최적화 → 8년 검증에서 실패**
   - 2023-2025 Sharpe 0.72 → 2018-2025 Sharpe 0.11
   - 과적합의 전형적 징후: 짧은 기간 최적화, 긴 기간에서 성능 저하

2. **평균회귀는 BTC 단일 에셋에서 구조적 한계**
   - BTC는 장기 우상향 + 높은 변동성 → 추세 추종이 유리
   - 평균회귀는 변동성 낮은 자산(주가지수, FX)에 더 적합

3. **ADX 필터는 두 전략 모두에서 실패**
   - TSMOM: 횡보 필터 효과 미미
   - BB+RSI: 추세 필터가 오히려 성과 악화
   - BTC의 레짐 분포(Bull 44%, Bear 26%, Sideways 30%)가 균등하지 않아 필터링이 비효율적

4. **분산 효과의 가치**
   - 단독으로 나쁜 전략도 음의 상관이면 포트폴리오에 가치
   - 50/50 합성 Sharpe(1.10) > TSMOM 단독(1.04)

---

## 교차 전략 분석 (TSMOM + BB+RSI)

**분석 일자:** 2026-02-06
**데이터:** BTC/USDT 1D, 2018-01-01 ~ 2025-12-31 (8년, 2,922일)
**데이터 소스:** Binance Spot, 1분봉 Silver 데이터에서 일봉 집계

### 상관관계

```
         TSMOM  BB+RSI  BTC B&H
TSMOM    1.000  -0.265    0.135
BB+RSI  -0.265   1.000    0.670
BTC B&H  0.135   0.670    1.000
```

- **TSMOM vs BB+RSI: r = -0.265** (음의 상관 = 분산 효과 우수)
- TSMOM vs BTC: r = 0.135 (거의 시장 중립)
- BB+RSI vs BTC: r = 0.670 (시장 방향에 의존, long-only이므로 당연)

#### 연도별 상관 변화

| 연도 | 상관계수 | 해석 |
|------|---------|------|
| 2018 | -0.527 | 하락장에서 강한 음의 상관 |
| 2019 | -0.265 | 평균 수준 |
| 2020 | -0.259 | 평균 수준 |
| 2021 | +0.072 | 유일하게 약한 양의 상관 |
| 2022 | -0.385 | 하락장에서 음의 상관 강화 |
| 2023 | -0.143 | 약한 음의 상관 |
| 2024 | -0.103 | 약한 음의 상관 |
| 2025 | -0.502 | 혼조장에서 강한 음의 상관 |

### 레짐별 성과 (Sharpe Ratio)

레짐 정의: 60일 누적 BTC 수익률 기준 (Bull > +10%, Bear < -10%, 나머지 Sideways)

| 레짐 | 비중 | TSMOM | BB+RSI | 50/50 Combo | BTC B&H |
|------|:---:|:---:|:---:|:---:|:---:|
| **Bull** | 43.6% | 2.33 | 2.42 | **2.54** | 3.08 |
| **Bear** | 26.1% | **1.04** | -2.12 | 0.28 | -2.48 |
| **Sideways** | 30.3% | -1.13 | **0.83** | -1.01 | 0.77 |

**핵심 발견:**
- Bull: 두 전략 모두 양수, Combo가 가장 높은 Sharpe
- Bear: TSMOM만 양수 (추세 추종의 강점), BB+RSI는 큰 손실
- Sideways: BB+RSI만 양수 (평균회귀의 강점), TSMOM은 큰 손실
- **두 전략은 정확히 반대 레짐에서 강함 → 상호 보완성 확인**

### 포트폴리오 합성 (50/50 고정 배분)

| 전략 | Sharpe | CAGR | 총수익 | MDD | AnnVol | Calmar |
|------|:---:|:---:|:---:|:---:|:---:|:---:|
| **TSMOM** | 1.04 | +31.3% | +782% | -43.5% | 30.7% | 0.72 |
| **BB+RSI (opt)** | 0.11 | +0.5% | +4.5% | -15.8% | 7.3% | 0.03 |
| **50/50 Combo** | **1.10** | +16.5% | +239% | **-23.8%** | **14.8%** | 0.69 |
| BTC Buy&Hold | 0.69 | +26.5% | +555% | -81.2% | 65.7% | 0.33 |

**50/50 Combo의 가치:**
- Sharpe 1.10 > TSMOM 단독 1.04 (분산 효과로 +6%)
- MDD -23.8% vs TSMOM -43.5% (낙폭 45% 감소)
- 변동성 14.8% vs TSMOM 30.7% (변동성 52% 감소)
- **단점:** CAGR +16.5% vs TSMOM +31.3% (절대 수익 절반)

### 드로다운 분석

| 전략 | 최대 낙폭 | 낙폭 일자 | 회복 소요 |
|------|----------|----------|----------|
| TSMOM | -43.5% | 2018-11-15 | 177일 |
| BB+RSI | -15.8% | 2020-03-16 | 1,701일 |
| 50/50 Combo | -23.8% | 2018-11-15 | 177일 |
| BTC B&H | -81.2% | 2018-12-15 | 703일 |

**주의:** BB+RSI는 MDD는 작지만(-15.8%) 회복에 1,701일(4.7년) 소요 → 수익력 부족

### 결론

1. **TSMOM이 핵심 엔진** — 8년 Sharpe 1.04, CAGR +31.3%
2. **BB+RSI는 단독 운영 불가** — 8년 CAGR +0.5%, 단독 alpha 없음
3. **50/50 합성은 Sharpe 개선(1.10)이 있으나 CAGR 절반**
4. **Regime Adaptive(동적 전환)는 과적합 리스크가 높아 보류**
5. **다음 단계는 TSMOM 멀티에셋 확장이 가장 효율적**

---

## 폐기된 전략

### [Template] Strategy Name

**평가 일자:** YYYY-MM-DD
**상태:** ❌ 폐기
**폐기 사유:**

#### 개요
(전략 설명)

#### 테스트 결과
(성과 지표)

#### 실패 원인 분석
(왜 실패했는지)

#### 교훈
(향후 피해야 할 것)

---

## 메타 교훈 (Cross-Strategy Insights)

### 효과적인 것

- ✅ 변동성 타겟팅 (Vol Targeting) — 두 전략 모두에서 핵심 메커니즘
- ✅ 헤지 숏 모드 — TSMOM에서 MDD 개선
- ✅ 8년 이상 장기 백테스트 — 3년만으로는 불충분 (과적합 미발견)
- ✅ Sharpe 기반 평가 — 절대 수익보다 리스크 조정 수익
- ✅ 전략 간 상관 분석 — 음의 상관(r=-0.265)이 포트폴리오 가치의 핵심
- ✅ 파라미터 스윕 — 72개 조합 테스트로 robust한 파라미터 발견

### 효과 없는 것

- ❌ ADX 기반 필터 (TSMOM, BB+RSI 모두) — BTC 레짐 분포가 불균등
- ❌ MTF 필터 — 강세장에서 좋은 시그널도 제거
- ❌ 과도한 필터링 — 복잡성 증가 대비 성과 개선 없음
- ❌ BB+RSI 단독 운영 — BTC에서 평균회귀는 구조적 한계
- ❌ 짧은 기간 파라미터 최적화 — 2023-2025 최적값이 2018-2022에서 역효과

### 핵심 수치 요약

| 지표 | TSMOM | BB+RSI | 50/50 | BTC B&H |
|------|:---:|:---:|:---:|:---:|
| 8년 Sharpe | **1.04** | 0.11 | 1.10 | 0.69 |
| 8년 CAGR | **+31.3%** | +0.5% | +16.5% | +26.5% |
| MDD | -43.5% | **-15.8%** | -23.8% | -81.2% |
| AnnVol | 30.7% | **7.3%** | 14.8% | 65.7% |
| 상관(vs BTC) | 0.135 | 0.670 | - | 1.000 |

### 향후 방향

- ✅ **TSMOM 멀티에셋 확장** — 가장 효율적, 학술 검증됨, 인프라 준비 완료
- ⚠️ 50/50 고정 합성 — Sharpe 소폭 개선이나 CAGR 절반, 우선순위 낮음
- ❌ Regime Adaptive 동적 전환 — 과적합 리스크 높음, 보류

---

## 데이터 인벤토리

### BTC/USDT (Silver Layer, 1분봉)

| 연도 | 캔들 수 | Gap% | 비고 |
|------|--------|------|------|
| 2017 | 525,600 | 62.5% | 8/17부터 실데이터, 이전은 gap-fill |
| 2018 | 525,600 | 0.7% | 전체 |
| 2019 | 525,600 | 0.3% | 전체 |
| 2020 | 527,040 | 0.2% | 윤년 |
| 2021 | 525,600 | 0.1% | 전체 |
| 2022 | 525,600 | -0.1% | 전체 |
| 2023 | 525,600 | - | 기존 보유 |
| 2024 | 527,040 | - | 기존 보유 |
| 2025 | 525,600 | - | 기존 보유 |
| **합계** | **4,733,280** | | **9년, 115.7MB** |

---

## 변경 이력

| 날짜 | 변경 내용 |
|------|----------|
| 2026-02-06 | 초기 문서 생성, VW-TSMOM 평가 추가 |
| 2026-02-06 | BB+RSI 평가, 교차 전략 분석, 8년 데이터 검증 결과 추가 |
| 2026-02-06 | 2017-2022 BTC 데이터 수집, 데이터 인벤토리 추가 |
