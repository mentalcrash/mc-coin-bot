# ==============================================================================
# Orchestrator Live Config — 1 Pod (Anchor-Mom)
# ==============================================================================
#
# 2026-02-22 업데이트:
#   ML 전략 전멸 (look-ahead bias 발견):
#     - CTREND, CTREND-X, GBTrend, Vol-Term ML → 전량 RETIRED
#     - resolved_end 패턴 적용 후 Sharpe 전부 음수
#   유일한 ACTIVE 전략: Anchor-Mom (12H, P7 PASS)
#
# 에셋 선별:
#   - Anchor-Mom: DOGE(1.36) SOL(1.01) — Sharpe ≥ 1.0
#
# 단일 Pod 운영:
#   - Orchestrator 프레임워크는 유지 (새 전략 추가 시 즉시 확장 가능)
#   - Allocation/Correlation/Turnover는 단일 Pod에서 무관하나 기본값 유지
#   - initial_fraction: 1.0 (전체 자본 투입)
#
# 배포 전 필수 검증:
#   1. uv run mcbot orchestrate backtest config/orchestrator-live.yaml --report
#   2. uv run mcbot orchestrate paper config/orchestrator-live.yaml -V
#   3. Paper 24h+ 안정성 확인 후 Live 전환
#
# CLI:
#   Paper : uv run mcbot orchestrate paper config/orchestrator-live.yaml -V
#   Live  : uv run mcbot orchestrate live  config/orchestrator-live.yaml -V
# ==============================================================================

backtest:
  timeframe: "12H"
  start: "2024-01-01"
  end: "2025-12-31"
  capital: 10000.0

orchestrator:
  # ── Allocation ──────────────────────────────────────────────
  allocation_method: equal_weight       # 1 Pod → EW = 100%
  kelly_fraction: 0.25
  kelly_confidence_ramp: 180

  # ── Rebalance ───────────────────────────────────────────────
  rebalance_trigger: hybrid             # calendar + drift
  rebalance_calendar_days: 7
  rebalance_drift_threshold: 0.10

  # ── Portfolio Risk ──────────────────────────────────────────
  max_gross_leverage: 2.0
  max_portfolio_drawdown: 0.15
  max_portfolio_volatility: 0.20
  max_single_pod_risk_pct: 1.0          # 1-Pod → 100% 허용
  daily_loss_limit: 0.03
  cost_bps: 4.0

  # ── Correlation ─────────────────────────────────────────────
  correlation_lookback: 90
  correlation_stress_threshold: 0.70

  # ── Lifecycle: Graduation ───────────────────────────────────
  graduation:
    min_live_days: 30
    min_sharpe: 0.5
    max_drawdown: 0.20
    min_trade_count: 5
    min_calmar: 0.3
    max_backtest_live_gap: 0.30
    max_portfolio_correlation: 0.65

  # ── Lifecycle: Retirement ───────────────────────────────────
  retirement:
    max_drawdown_breach: 0.25           # MDD > 25% → 즉시 RETIRED
    consecutive_loss_months: 6
    rolling_sharpe_floor: 0.3
    probation_days: 30

  # ── Pods ────────────────────────────────────────────────────
  pods:
    # ────────────────────────────────────────────────────────
    # Pod 1: Anchor-Mom — Anchored Momentum (12H, G2H 최적화)
    # 유일한 ACTIVE 전략 (P7 PASS)
    # G2H IS=1.75, OOS=0.78 — 원본 12H TF + G2H 최적화 파라미터
    # 에셋: Sharpe ≥ 1.0 — DOGE(1.36) SOL(1.01)
    # 제외: BNB(0.90) ETH(0.84) BTC(0.58)
    # ────────────────────────────────────────────────────────
    - pod_id: pod-anchor-mom
      strategy_name: anchor-mom
      strategy_params:
        nearness_lookback: 29            # G2H 최적화 (기본 60)
        mom_lookback: 51                 # G2H 최적화 (기본 30)
        strong_nearness: 0.9692          # G2H 최적화 (기본 0.95)
        weak_nearness: 0.8555           # G2H 최적화 (기본 0.85)
        short_nearness: 0.5293          # G2H 최적화 (기본 0.80)
        vol_target: 0.35
        vol_window: 12                   # G2H 최적화 (기본 30)
        min_volatility: 0.05
        annualization_factor: 730.0      # 12H (하루 2봉)
        atr_period: 22                   # G2H 최적화 (기본 14)
        short_mode: 1                    # HEDGE_ONLY
        hedge_threshold: -0.07
        hedge_strength_ratio: 0.8
      symbols:
        - DOGE/USDT
        - SOL/USDT
      timeframe: "12H"
      initial_fraction: 1.0             # 단일 Pod → 전체 자본
      max_fraction: 1.0
      min_fraction: 0.50
      max_drawdown: 0.20
      drawdown_warning: 0.15
      max_leverage: 2.0
      system_stop_loss: 0.10
      use_trailing_stop: true
      trailing_stop_atr_multiplier: 3.0
      rebalance_threshold: 0.10
      # asset_allocation 생략 → equal_weight (2 에셋이면 EW 충분)
