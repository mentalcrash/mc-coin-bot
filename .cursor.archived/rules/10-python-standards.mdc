---
description: Python 3.13 Coding Standards & Modern Conventions (Asyncio, Pydantic, Typing)
globs: **/*.py
alwaysApply: false
---

# ğŸ Python 3.13 Modern Coding Standards

## 1. Core Syntax & Versioning
- **Version:** Python 3.13+ ë¬¸ë²•ì„ ì—„ê²©íˆ ì¤€ìˆ˜í•©ë‹ˆë‹¤.
- **Modern Typing:**
    - `Union[X, Y]` ëŒ€ì‹  `X | Y` ë¬¸ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - `Optional[X]` ëŒ€ì‹  `X | None`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - ë¦¬í„´ íƒ€ì…ì´ ìê¸° ìì‹ ì¼ ê²½ìš° `from typing import Self`ë¥¼ ì‚¬ìš©í•˜ì—¬ `-> Self`ë¡œ ëª…ì‹œí•©ë‹ˆë‹¤.
    - ì»¬ë ‰ì…˜ íƒ€ì…ì€ `List`, `Dict` ëŒ€ì‹  ë‚´ì¥ ì œë„¤ë¦­ `list[]`, `dict[]`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

## 2. Async & Concurrency (Critical for Trading)
- **Structured Concurrency:** `asyncio.gather()`ë³´ë‹¤ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ê°€ ì•ˆì „í•œ **`asyncio.TaskGroup`** (Python 3.11+) íŒ¨í„´ì„ ìš°ì„  ì‚¬ìš©í•©ë‹ˆë‹¤.
- **Non-blocking:** I/O ë°”ìš´ë“œ ì‘ì—…(ë„¤íŠ¸ì›Œí¬, DB)ì€ ë°˜ë“œì‹œ `await` í‚¤ì›Œë“œì™€ í•¨ê»˜ ë¹„ë™ê¸° í•¨ìˆ˜ë¡œ ì‘ì„±í•©ë‹ˆë‹¤. `time.sleep()`ì€ ì ˆëŒ€ ê¸ˆì§€ì´ë©° `await asyncio.sleep()`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

## 3. Data Validation & Structure
- **Pydantic V2:** ë°ì´í„° ëª¨ë¸ë§(API ì‘ë‹µ, ì„¤ì • íŒŒì¼)ì—ëŠ” `dataclasses` ëŒ€ì‹  `pydantic.BaseModel`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - ì´ìœ : ëŸ°íƒ€ì„ íƒ€ì… ê²€ì¦ê³¼ ê°•ë ¥í•œ ì§ë ¬í™” ì„±ëŠ¥.
- **Config Management:** í™˜ê²½ ë³€ìˆ˜ ë¡œë“œëŠ” `pydantic-settings`ë¥¼ í™œìš©í•˜ì—¬ íƒ€ì… ì•ˆì „ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.

## 4. Quant/Financial Precision
- **No Floats for Money:** ê°€ê²©(Price), ìˆ˜ëŸ‰(Amount), ì”ê³ (Balance) ê³„ì‚°ì—ëŠ” ì ˆëŒ€ `float`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    - **ë°˜ë“œì‹œ `decimal.Decimal`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.**
    - ë‚˜ëˆ—ì…ˆ ì—°ì‚° ì‹œ `getcontext().prec`ë¥¼ í™•ì¸í•˜ê±°ë‚˜ ì–‘ìí™”(`quantize`) ì²˜ë¦¬ë¥¼ í•©ë‹ˆë‹¤.

## 5. Code Style & Quality (Ruff Style)
- **Linter Standard:** `Ruff` ë¦°í„° ê·œì¹™ì„ ë”°ë¥´ëŠ” ì½”ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. (ë¶ˆí•„ìš”í•œ ì„í¬íŠ¸ ì œê±°, ë³µì¡ë„ ê´€ë¦¬)
- **Docstrings:** Google Style Docstringì„ ì ìš©í•©ë‹ˆë‹¤. ëª¨ë“  Public í•¨ìˆ˜ì™€ í´ë˜ìŠ¤ì—ëŠ” ì„¤ëª…, ì¸ì(Args), ë°˜í™˜ê°’(Returns), ë°œìƒ ì˜ˆì™¸(Raises)ë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤.
- **Early Return:** ì¤‘ì²©ëœ `if/else` ë¸”ë¡ì„ í”¼í•˜ê³ , Guard Clause(ì¡°ê±´ ë¶ˆë§Œì¡± ì‹œ ì¦‰ì‹œ ë¦¬í„´) íŒ¨í„´ì„ ì‚¬ìš©í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì…ë‹ˆë‹¤.

## 6. Example Patterns

### âœ… Good (Modern & Safe)
```python
from decimal import Decimal
import asyncio
from pydantic import BaseModel

class Order(BaseModel):
    symbol: str
    price: Decimal
    amount: Decimal

async def process_orders(orders: list[Order]) -> None:
    async with asyncio.TaskGroup() as tg:
        for order in orders:
            tg.create_task(execute_order(order))

```

### âŒ Bad (Legacy & Unsafe)

```python
# float ì‚¬ìš©, êµ¬í˜• íƒ€ì´í•‘, gather ì‚¬ìš©
from typing import List
import asyncio

async def process_orders(orders: List[dict]):
    tasks = []
    for order in orders:
        # Dangerous float math
        total = order['price'] * order['amount'] 
        tasks.append(execute_order(order))
    await asyncio.gather(*tasks) # ì˜ˆì™¸ ë°œìƒ ì‹œ ë‚˜ë¨¸ì§€ íƒœìŠ¤í¬ ì²˜ë¦¬ ë¶ˆëª…í™•

```