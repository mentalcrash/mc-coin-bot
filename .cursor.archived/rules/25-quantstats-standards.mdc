---
description: QuantStats Reporting Standards (Crypto Settings, HTML Reports)
globs: **/backtest/*.py, **/analysis/*.py, **/reports/*.py
alwaysApply: false
---

# ğŸ“ˆ QuantStats Standards (2026 Crypto Edition)

## 1. Core Philosophy: The "Report Card"
- **Role:** QuantStatsëŠ” ì „ëµ ë¡œì§ ë‚´ë¶€ì—ì„œ ê³„ì‚°ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë“  ì‹œë®¬ë ˆì´ì…˜ì´ ëë‚œ í›„, ìµœì¢… ê²€ì¦ ë° ì‹œê°í™” ìš©ë„(Post-Analysis)ë¡œë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **Format:** ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì¶œë ¥ë³´ë‹¤ëŠ” **HTML Tearsheet** ìƒì„±ì„ í‘œì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤.

## 2. Crypto-Specific Configuration (Crucial)
ì•”í˜¸í™”íëŠ” ì£¼ì‹ ì‹œì¥ê³¼ êµ¬ì¡°ê°€ ë‹¤ë¥´ë¯€ë¡œ, ê¸°ë³¸ ì„¤ì •ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ í†µê³„ì  ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤. ì•„ë˜ ì„¤ì •ì„ **ë°˜ë“œì‹œ** ë®ì–´ì¨ì•¼ í•©ë‹ˆë‹¤.

- **Trading Periods:** ì•”í˜¸í™”íëŠ” 1ë…„ 365ì¼ 24ì‹œê°„ ê±°ë˜ë©ë‹ˆë‹¤.
    - âŒ Default: `periods=252` (ì£¼ì‹ ì˜ì—…ì¼ ê¸°ì¤€)
    - âœ… **Override:** `periods=365`
- **Benchmark:** S&P 500(SPY)ì€ ì•”í˜¸í™”í ì „ëµì˜ ë²¤ì¹˜ë§ˆí¬ë¡œ ë¶€ì ì ˆí•©ë‹ˆë‹¤.
    - âœ… **Benchmark:** `BTC-USD` (ë¹„íŠ¸ì½”ì¸) ë˜ëŠ” `ETH-USD` (ì´ë”ë¦¬ì›€)
- **Timezone:** ëª¨ë“  ì…ë ¥ ë°ì´í„°ëŠ” Rule #12ì— ë”°ë¼ **UTC** ê¸°ì¤€ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

## 3. Data Preparation Pipeline
- **Sanitization:** QSì— ë°ì´í„°ë¥¼ ë„˜ê¸°ê¸° ì „, ë¬´í•œëŒ€ ê°’(`inf`)ì´ë‚˜ ê²°ì¸¡ì¹˜(`NaN`)ë¥¼ ë°˜ë“œì‹œ ì œê±°í•˜ê±°ë‚˜ `0`ìœ¼ë¡œ ì±„ì›Œì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.
- **Input Type:** `vectorbt`ì˜ ê²°ê³¼ë¬¼(`portfolio.returns()`)ì„ Pandas Seriesë¡œ ë³€í™˜í•˜ì—¬ ì „ë‹¬í•©ë‹ˆë‹¤.

## 4. Reporting Workflow
- **File Naming:** ë¦¬í¬íŠ¸ íŒŒì¼ëª…ì—ëŠ” ë°˜ë“œì‹œ **ì „ëµëª…**ê³¼ **ìƒì„± ì‹œê°„(Timestamp)**ì´ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
    - ì˜ˆ: `reports/RSI_Strategy_20260131_1400.html`
- **Headless Mode:** ì„œë²„ í™˜ê²½ì—ì„œ ë´‡ì´ ëŒê¸° ë•Œë¬¸ì—, ë¦¬í¬íŠ¸ ìƒì„± í›„ ë¸Œë¼ìš°ì €ë¥¼ ìë™ìœ¼ë¡œ ì—¬ëŠ” ì˜µì…˜ì€ ëˆ ìƒíƒœë¡œ ì €ì¥í•©ë‹ˆë‹¤. (`auto_open=False`)

## 5. Integration with Streamlit (Optional)
- **Dashboard Embedding:** ìƒì„±ëœ HTML ë¦¬í¬íŠ¸ëŠ” Streamlit ëŒ€ì‹œë³´ë“œ ë‚´ì— iframeìœ¼ë¡œ ì„ë² ë”©í•˜ì—¬ ë³¼ ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
    - `streamlit.components.v1.html(html_content, ...)`

## 6. Example Pattern

### âœ… Good (Crypto-Optimized)
```python
import quantstats as qs
import pandas as pd
from datetime import datetime

# Rule #12: VectorBT returns are already vectorized
def generate_report(returns: pd.Series, benchmark_ticker: str = "BTC-USD"):
    """
    Generate QuantStats HTML report with Crypto settings
    """
    # 1. Extend Pandas Functionality
    qs.extend_pandas()
    
    # 2. Sanitize Data
    clean_returns = returns.replace([float('inf'), -float('inf')], 0).fillna(0)
    
    # 3. Generate Timestamped Filename
    timestamp = datetime.now().strftime("%Y%m%d_%H%M")
    filename = f"reports/Backtest_{timestamp}.html"
    
    # 4. Create Tearsheet (Crypto Settings Applied)
    qs.reports.html(
        clean_returns,
        benchmark=benchmark_ticker,
        output=filename,
        title=f"Crypto Bot Performance (vs {benchmark_ticker})",
        periods=365,      # [IMPORTANT] Crypto trades 365 days
        compounded=True,  # Crypto strategies usually compound
        auto_open=False   # Server friendly
    )
    
    print(f"Report saved to: {filename}")

```

### âŒ Bad (Stock Defaults)

```python
import quantstats as qs

def bad_report(returns):
    # ê¸°ë³¸ê°’ ì‚¬ìš© ì‹œ SPYì™€ ë¹„êµë¨ (ë¬´ì˜ë¯¸)
    # periods=252ê°€ ì ìš©ë˜ì–´ ìƒ¤í”„ ë¹„ìœ¨ì´ ê³¼ëŒ€/ê³¼ì†Œ í‰ê°€ë¨
    qs.reports.html(returns, output="report.html") 

```